import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon
from matplotlib.colors import Normalize
from numpy import array


# Part 1: 3D to 2D transformation function for dictionary-based input
def transform_3d_to_2d(rooftop_data):
    """
    Transform 3D rooftop data into 2D representation by removing the z-dimension.

    Args:
        rooftop_data: Dictionary where each key is a mesh ID and value contains mesh data

    Returns:
        dict: A dictionary with 2D representation data and metadata necessary for visualization
    """
    transformed_data = {
        'quads': [],
        'min_radiance': float('inf'),
        'max_radiance': float('-inf'),
        'x_limits': [float('inf'), float('-inf')],
        'y_limits': [float('inf'), float('-inf')]
    }

    # Group by mesh_index to maintain structure similar to original code
    mesh_indices = set(quad_data['mesh_index'] for quad_data in rooftop_data.values())
    mesh_index_map = {}

    for mesh_id, quad_data in rooftop_data.items():
        mesh_index = quad_data['mesh_index']
        if mesh_index not in mesh_index_map:
            mesh_index_map[mesh_index] = []
        mesh_index_map[mesh_index].append((mesh_id, quad_data))

    # Process each quad in the data
    for mesh_id, quad_data in rooftop_data.items():
        coords = quad_data['original_coordinates']
        x_coords = [coord[0] for coord in coords]
        y_coords = [coord[1] for coord in coords]

        polygon_coords = list(zip(x_coords, y_coords))
        centroid = quad_data['centroid'][:2]  # Take only x, y coordinates

        radiance = quad_data['average_radiance']
        transformed_data['min_radiance'] = min(transformed_data['min_radiance'], radiance)
        transformed_data['max_radiance'] = max(transformed_data['max_radiance'], radiance)

        transformed_data['x_limits'][0] = min(transformed_data['x_limits'][0], min(x_coords))
        transformed_data['x_limits'][1] = max(transformed_data['x_limits'][1], max(x_coords))
        transformed_data['y_limits'][0] = min(transformed_data['y_limits'][0], min(y_coords))
        transformed_data['y_limits'][1] = max(transformed_data['y_limits'][1], max(y_coords))

        transformed_data['quads'].append({
            'mesh_id': mesh_id,
            'polygon_coords': polygon_coords,
            'centroid': centroid,
            'radiance': radiance,
            'mesh_index': quad_data['mesh_index']
        })

    return transformed_data


# Part 2: Visualization function for dictionary-based input
def visualize_rooftop_2d(rooftop_data):
    """
    Display the 2D rooftop visualization for dictionary-based input.

    Args:
        rooftop_data: Dictionary where each key is a mesh ID and value contains mesh data

    Returns:
        tuple: (fig, ax) Matplotlib figure and axis objects
    """
    transformed_data = transform_3d_to_2d(rooftop_data)

    # Create figure with a single subplot
    fig, ax = plt.subplots(figsize=(12, 10))
    norm = Normalize(transformed_data['min_radiance'], transformed_data['max_radiance'])

    # Draw each quad
    for quad in transformed_data['quads']:
        polygon = Polygon(
            quad['polygon_coords'],
            closed=True,
            edgecolor='black',
            facecolor=plt.cm.viridis(norm(quad['radiance'])),
            alpha=0.7
        )
        ax.add_patch(polygon)

        # Add mesh ID and mesh index as text
        ax.text(
            quad['centroid'][0],
            quad['centroid'][1],
            f"{quad['mesh_id']}\n(idx:{quad['mesh_index']})",
            ha='center',
            va='center',
            fontsize=8,
            color='white'
        )

    # Set axis limits with a small margin
    margin = 0.000005
    ax.set_xlim(transformed_data['x_limits'][0] - margin, transformed_data['x_limits'][1] + margin)
    ax.set_ylim(transformed_data['y_limits'][0] - margin, transformed_data['y_limits'][1] + margin)
    ax.set_aspect('equal')

    # Add colorbar for radiance values
    sm = plt.cm.ScalarMappable(cmap=plt.cm.viridis, norm=norm)
    sm.set_array([])
    plt.colorbar(sm, ax=ax, label='Average Radiance')

    # Labels and title
    ax.set_xlabel('Longitude')
    ax.set_ylabel('Latitude')
    ax.set_title('Rooftop Visualization')

    plt.tight_layout()
    plt.show()

    return fig, ax


# Example usage:
# First, parse the input string to create the dictionary
import ast

# For demonstration, assume rooftop_data_str contains your input string
# rooftop_data = ast.literal_eval(rooftop_data_str)
# visualize_rooftop_2d(rooftop_data)

# Or if you have the data directly:
# Sample of how your data structure would look (not the full dataset)
#sample_data = {'Mesh_1': {'average_radiance': 100.03493472305283, 'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11366799038650678, 52.198555206146125, 3.75]], 'centroid': array([ 0.11367229, 52.19856282,  4.09412852]), 'mesh_index': 0}, 'Mesh_2': {'average_radiance': 100.03493499579402, 'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11366799038650678, 52.198555206146125, 3.75], [0.1136936556405145, 52.198563885243246, 3.75]], 'centroid': array([ 0.11368298, 52.19856335,  3.92206426]), 'mesh_index': 0}, 'Mesh_3': {'average_radiance': 100.03492804180844, 'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11363594925118636, 52.19855361021791, 4.266192772977321]], 'centroid': array([ 0.11363631, 52.1985656 ,  4.92925768]), 'mesh_index': 1}, 'Mesh_4': {'average_radiance': 100.03493125505429, 'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11366161450519408, 52.19856228931502, 4.266192772977321]], 'centroid': array([ 0.11364896, 52.19856395,  4.59772523]), 'mesh_index': 1}, 'Mesh_5': {'average_radiance': 100.03494344099472, 'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11364232513249907, 52.198546527049004, 3.75]], 'centroid': array([ 0.11364663, 52.19855414,  4.09412852]), 'mesh_index': 2}, 'Mesh_6': {'average_radiance': 100.03494369574643, 'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11364232513249907, 52.198546527049004, 3.75], [0.11366799038650678, 52.198555206146125, 3.75]], 'centroid': array([ 0.11365731, 52.19855467,  3.92206426]), 'mesh_index': 2}, 'Mesh_7': {'average_radiance': 100.03493672370614, 'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11361028399717865, 52.198544931120786, 4.266192772977321]], 'centroid': array([ 0.11361065, 52.19855692,  4.92925768]), 'mesh_index': 3}, 'Mesh_8': {'average_radiance': 100.03493993696398, 'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11363594925118636, 52.19855361021791, 4.266192772977321]], 'centroid': array([ 0.1136233 , 52.19855527,  4.59772523]), 'mesh_index': 3}, 'Mesh_9': {'average_radiance': 100.03495212290215, 'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11361665987849136, 52.19853784795189, 3.75]], 'centroid': array([ 0.11362096, 52.19854546,  4.09412852]), 'mesh_index': 4}, 'Mesh_10': {'average_radiance': 100.03495241368665, 'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11361665987849136, 52.19853784795189, 3.75], [0.11364232513249907, 52.198546527049004, 3.75]], 'centroid': array([ 0.11363164, 52.198546  ,  3.92206426]), 'mesh_index': 4}, 'Mesh_11': {'average_radiance': 100.03496082279736, 'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11359099462448365, 52.19852916885477, 3.75]], 'centroid': array([ 0.1135953 , 52.19853678,  4.09412852]), 'mesh_index': 5}, 'Mesh_12': {'average_radiance': 100.03496109558051, 'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11359099462448365, 52.19852916885477, 3.75], [0.11361665987849136, 52.19853784795189, 3.75]], 'centroid': array([ 0.11360598, 52.19853732,  3.92206426]), 'mesh_index': 5}}
sample_data = {'Mesh_1': {'average_radiance': 100.03492735694, 'original_coordinates': [[0.11370011238620566, 52.1985753079607, 4.266192772977321], [0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11369342226548204, 52.198564144506975, 3.76889409467354]], 'centroid': array([ 0.1136936 , 52.19857014,  4.10042655]), 'mesh_index': 0}, 'Mesh_2': {'average_radiance': 100.03492896355068, 'original_coordinates': [[0.11370011238620566, 52.1985753079607, 4.266192772977321], [0.11369342226548204, 52.198564144506975, 3.76889409467354], [0.1137062548924859, 52.198568484055535, 3.76889409467354]], 'centroid': array([ 0.11369993, 52.19856931,  3.93466032]), 'mesh_index': 0}, 'Mesh_3': {'average_radiance': 100.03492253709966, 'original_coordinates': [[0.11368113725292155, 52.19857779231731, 4.763491451281101], [0.11366830462591769, 52.19857345276875, 4.763491451281101], [0.11367444713219793, 52.19856662886358, 4.266192772977321]], 'centroid': array([ 0.11367463, 52.19857262,  4.59772523]), 'mesh_index': 1}, 'Mesh_4': {'average_radiance': 100.0349241437383, 'original_coordinates': [[0.11368113725292155, 52.19857779231731, 4.763491451281101], [0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.1136872797592018, 52.19857096841214, 4.266192772977321]], 'centroid': array([ 0.11368095, 52.1985718 ,  4.431959  ]), 'mesh_index': 1}, 'Mesh_5': {'average_radiance': 100.03493170694773, 'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.11368058963847819, 52.198559804958414, 3.76889409467354]], 'centroid': array([ 0.11368077, 52.1985658 ,  4.10042655]), 'mesh_index': 2}, 'Mesh_6': {'average_radiance': 100.03493331353764, 'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11368058963847819, 52.198559804958414, 3.76889409467354], [0.11369342226548204, 52.198564144506975, 3.76889409467354]], 'centroid': array([ 0.1136871 , 52.19856497,  3.93466032]), 'mesh_index': 2}, 'Mesh_7': {'average_radiance': 100.03491771724687, 'original_coordinates': [[0.11366216211963745, 52.198580276673916, 5.260790129584881], [0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11365547199891383, 52.19856911322019, 4.763491451281101]], 'centroid': array([ 0.11365565, 52.19857511,  5.0950239 ]), 'mesh_index': 3}, 'Mesh_8': {'average_radiance': 100.03491932386585, 'original_coordinates': [[0.11366216211963745, 52.198580276673916, 5.260790129584881], [0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11366830462591769, 52.19857345276875, 4.763491451281101]], 'centroid': array([ 0.11366198, 52.19857428,  4.92925768]), 'mesh_index': 3}, 'Mesh_9': {'average_radiance': 100.0349268870746, 'original_coordinates': [[0.11366830462591769, 52.19857345276875, 4.763491451281101], [0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11366161450519408, 52.19856228931502, 4.266192772977321]], 'centroid': array([ 0.1136618 , 52.19856829,  4.59772523]), 'mesh_index': 4}, 'Mesh_10': {'average_radiance': 100.03492849369242, 'original_coordinates': [[0.11366830462591769, 52.19857345276875, 4.763491451281101], [0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11367444713219793, 52.19856662886358, 4.266192772977321]], 'centroid': array([ 0.11366812, 52.19856746,  4.431959  ]), 'mesh_index': 4}, 'Mesh_11': {'average_radiance': 100.03493605690203, 'original_coordinates': [[0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11366775701147433, 52.198555465409854, 3.76889409467354]], 'centroid': array([ 0.11366794, 52.19856146,  4.10042655]), 'mesh_index': 5}, 'Mesh_12': {'average_radiance': 100.03493766351869, 'original_coordinates': [[0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.11366775701147433, 52.198555465409854, 3.76889409467354], [0.11368058963847819, 52.198559804958414, 3.76889409467354]], 'centroid': array([ 0.11367426, 52.19856063,  3.93466032]), 'mesh_index': 5}, 'Mesh_13': {'average_radiance': 100.03491293340291, 'original_coordinates': [[0.11364318698635335, 52.19858276103052, 5.75808880788866], [0.1136303543593495, 52.19857842148197, 5.75808880788866], [0.11363649686562974, 52.1985715975768, 5.260790129584881]], 'centroid': array([ 0.11363668, 52.19857759,  5.59232258]), 'mesh_index': 6}, 'Mesh_14': {'average_radiance': 100.03491454002604, 'original_coordinates': [[0.11364318698635335, 52.19858276103052, 5.75808880788866], [0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.1136493294926336, 52.198575937125355, 5.260790129584881]], 'centroid': array([ 0.113643  , 52.19857677,  5.42655636]), 'mesh_index': 6}, 'Mesh_15': {'average_radiance': 100.03492210323482, 'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.11364263937190998, 52.19856477367163, 4.763491451281101]], 'centroid': array([ 0.11364282, 52.19857077,  5.0950239 ]), 'mesh_index': 7}, 'Mesh_16': {'average_radiance': 100.03492367383478, 'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11365547199891383, 52.19856911322019, 4.763491451281101]], 'centroid': array([ 0.11364915, 52.19856994,  4.92925768]), 'mesh_index': 7}, 'Mesh_17': {'average_radiance': 100.03493123704362, 'original_coordinates': [[0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11364878187819022, 52.19855794976646, 4.266192772977321]], 'centroid': array([ 0.11364896, 52.19856395,  4.59772523]), 'mesh_index': 8}, 'Mesh_18': {'average_radiance': 100.03493284366448, 'original_coordinates': [[0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11366161450519408, 52.19856228931502, 4.266192772977321]], 'centroid': array([ 0.11365529, 52.19856312,  4.431959  ]), 'mesh_index': 8}, 'Mesh_19': {'average_radiance': 100.03494040687416, 'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11365492438447047, 52.19855112586129, 3.76889409467354]], 'centroid': array([ 0.11365511, 52.19855712,  4.10042655]), 'mesh_index': 9}, 'Mesh_20': {'average_radiance': 100.03494201349382, 'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11365492438447047, 52.19855112586129, 3.76889409467354], [0.11366775701147433, 52.198555465409854, 3.76889409467354]], 'centroid': array([ 0.11366143, 52.19855629,  3.93466032]), 'mesh_index': 9}, 'Mesh_21': {'average_radiance': 100.03490807750396, 'original_coordinates': [[0.11362421185306926, 52.198585245387136, 6.25538748619244], [0.1136113792260654, 52.198580905838575, 6.25538748619244], [0.11361752173234564, 52.19857408193341, 5.75808880788866]], 'centroid': array([ 0.1136177 , 52.19858008,  6.08962126]), 'mesh_index': 10}, 'Mesh_22': {'average_radiance': 100.03490968413124, 'original_coordinates': [[0.11362421185306926, 52.198585245387136, 6.25538748619244], [0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.1136303543593495, 52.19857842148197, 5.75808880788866]], 'centroid': array([ 0.11362403, 52.19857925,  5.92385503]), 'mesh_index': 10}, 'Mesh_23': {'average_radiance': 100.03491724733854, 'original_coordinates': [[0.1136303543593495, 52.19857842148197, 5.75808880788866], [0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.11362366423862588, 52.19856725802824, 5.260790129584881]], 'centroid': array([ 0.11362385, 52.19857325,  5.59232258]), 'mesh_index': 11}, 'Mesh_24': {'average_radiance': 100.03491885396468, 'original_coordinates': [[0.1136303543593495, 52.19857842148197, 5.75808880788866], [0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11363649686562974, 52.1985715975768, 5.260790129584881]], 'centroid': array([ 0.11363017, 52.19857243,  5.42655636]), 'mesh_index': 11}, 'Mesh_25': {'average_radiance': 100.03492641717281, 'original_coordinates': [[0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11362980674490612, 52.198560434123074, 4.763491451281101]], 'centroid': array([ 0.11362999, 52.19856643,  5.0950239 ]), 'mesh_index': 12}, 'Mesh_26': {'average_radiance': 100.03492805981982, 'original_coordinates': [[0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11364263937190998, 52.19856477367163, 4.763491451281101]], 'centroid': array([ 0.11363631, 52.1985656 ,  4.92925768]), 'mesh_index': 12}, 'Mesh_27': {'average_radiance': 100.03493562302803, 'original_coordinates': [[0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11363594925118636, 52.19855361021791, 4.266192772977321]], 'centroid': array([ 0.11363613, 52.19855961,  4.59772523]), 'mesh_index': 13}, 'Mesh_28': {'average_radiance': 100.03493722965196, 'original_coordinates': [[0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11364878187819022, 52.19855794976646, 4.266192772977321]], 'centroid': array([ 0.11364246, 52.19855878,  4.431959  ]), 'mesh_index': 13}, 'Mesh_29': {'average_radiance': 100.03494479286172, 'original_coordinates': [[0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11364209175746662, 52.19854678631274, 3.76889409467354]], 'centroid': array([ 0.11364227, 52.19855278,  4.10042655]), 'mesh_index': 14}, 'Mesh_30': {'average_radiance': 100.03494639948435, 'original_coordinates': [[0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11364209175746662, 52.19854678631274, 3.76889409467354], [0.11365492438447047, 52.19855112586129, 3.76889409467354]], 'centroid': array([ 0.1136486 , 52.19855195,  3.93466032]), 'mesh_index': 14}, 'Mesh_31': {'average_radiance': 100.03491242745186, 'original_coordinates': [[0.1136113792260654, 52.198580905838575, 6.25538748619244], [0.11359854659906155, 52.198576566290015, 6.25538748619244], [0.11360468910534179, 52.19856974238485, 5.75808880788866]], 'centroid': array([ 0.11360487, 52.19857574,  6.08962126]), 'mesh_index': 15}, 'Mesh_32': {'average_radiance': 100.03491403408214, 'original_coordinates': [[0.1136113792260654, 52.198580905838575, 6.25538748619244], [0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11361752173234564, 52.19857408193341, 5.75808880788866]], 'centroid': array([ 0.1136112 , 52.19857491,  5.92385503]), 'mesh_index': 15}, 'Mesh_33': {'average_radiance': 100.03492159728954, 'original_coordinates': [[0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11361083161162203, 52.19856291847968, 5.260790129584881]], 'centroid': array([ 0.11361101, 52.19856891,  5.59232258]), 'mesh_index': 16}, 'Mesh_34': {'average_radiance': 100.03492320391868, 'original_coordinates': [[0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11362366423862588, 52.19856725802824, 5.260790129584881]], 'centroid': array([ 0.11361734, 52.19856809,  5.42655636]), 'mesh_index': 16}, 'Mesh_35': {'average_radiance': 100.03493076712694, 'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11361697411790227, 52.19855609457451, 4.763491451281101]], 'centroid': array([ 0.11361716, 52.19856209,  5.0950239 ]), 'mesh_index': 17}, 'Mesh_36': {'average_radiance': 100.03493237375493, 'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11362980674490612, 52.198560434123074, 4.763491451281101]], 'centroid': array([ 0.11362348, 52.19856126,  4.92925768]), 'mesh_index': 17}, 'Mesh_37': {'average_radiance': 100.03493993696398, 'original_coordinates': [[0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11362311662418251, 52.198549270669346, 4.266192772977321]], 'centroid': array([ 0.1136233 , 52.19855527,  4.59772523]), 'mesh_index': 18}, 'Mesh_38': {'average_radiance': 100.0349415435908, 'original_coordinates': [[0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.11363594925118636, 52.19855361021791, 4.266192772977321]], 'centroid': array([ 0.11362962, 52.19855444,  4.431959  ]), 'mesh_index': 18}, 'Mesh_39': {'average_radiance': 100.03494910680072, 'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.11362925913046276, 52.19854244676418, 3.76889409467354]], 'centroid': array([ 0.11362944, 52.19854844,  4.10042655]), 'mesh_index': 19}, 'Mesh_40': {'average_radiance': 100.03495071342643, 'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11362925913046276, 52.19854244676418, 3.76889409467354], [0.11364209175746662, 52.19854678631274, 3.76889409467354]], 'centroid': array([ 0.11363577, 52.19854761,  3.93466032]), 'mesh_index': 19}, 'Mesh_41': {'average_radiance': 100.03492594723464, 'original_coordinates': [[0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11359185647833793, 52.19856540283629, 5.75808880788866], [0.11359799898461817, 52.19855857893112, 5.260790129584881]], 'centroid': array([ 0.11359818, 52.19856457,  5.59232258]), 'mesh_index': 20}, 'Mesh_42': {'average_radiance': 100.0349275538668, 'original_coordinates': [[0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11361083161162203, 52.19856291847968, 5.260790129584881]], 'centroid': array([ 0.11360451, 52.19856375,  5.42655636]), 'mesh_index': 20}, 'Mesh_43': {'average_radiance': 100.03493511707515, 'original_coordinates': [[0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11360414149089841, 52.19855175502595, 4.763491451281101]], 'centroid': array([ 0.11360432, 52.19855775,  5.0950239 ]), 'mesh_index': 21}, 'Mesh_44': {'average_radiance': 100.03493672370614, 'original_coordinates': [[0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.11361697411790227, 52.19855609457451, 4.763491451281101]], 'centroid': array([ 0.11361065, 52.19855692,  4.92925768]), 'mesh_index': 21}, 'Mesh_45': {'average_radiance': 100.03494428691532, 'original_coordinates': [[0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.11361028399717865, 52.198544931120786, 4.266192772977321]], 'centroid': array([ 0.11361047, 52.19855093,  4.59772523]), 'mesh_index': 22}, 'Mesh_46': {'average_radiance': 100.03494589354518, 'original_coordinates': [[0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11362311662418251, 52.198549270669346, 4.266192772977321]], 'centroid': array([ 0.11361679, 52.1985501 ,  4.431959  ]), 'mesh_index': 22}, 'Mesh_47': {'average_radiance': 100.03495345675516, 'original_coordinates': [[0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.1136164265034589, 52.19853810721562, 3.76889409467354]], 'centroid': array([ 0.11361661, 52.1985441 ,  4.10042655]), 'mesh_index': 23}, 'Mesh_48': {'average_radiance': 100.03495506338388, 'original_coordinates': [[0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.1136164265034589, 52.19853810721562, 3.76889409467354], [0.11362925913046276, 52.19854244676418, 3.76889409467354]], 'centroid': array([ 0.11362293, 52.19854327,  3.93466032]), 'mesh_index': 23}, 'Mesh_49': {'average_radiance': 100.03493946701747, 'original_coordinates': [[0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11358516635761431, 52.19855423938256, 5.260790129584881], [0.11359130886389456, 52.19854741547739, 4.763491451281101]], 'centroid': array([ 0.11359149, 52.19855341,  5.0950239 ]), 'mesh_index': 24}, 'Mesh_50': {'average_radiance': 100.03494107365147, 'original_coordinates': [[0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.11360414149089841, 52.19855175502595, 4.763491451281101]], 'centroid': array([ 0.11359782, 52.19855258,  4.92925768]), 'mesh_index': 24}, 'Mesh_51': {'average_radiance': 100.03494863686075, 'original_coordinates': [[0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.1135974513701748, 52.198540591572225, 4.266192772977321]], 'centroid': array([ 0.11359763, 52.19854659,  4.59772523]), 'mesh_index': 25}, 'Mesh_52': {'average_radiance': 100.03495024349361, 'original_coordinates': [[0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11361028399717865, 52.198544931120786, 4.266192772977321]], 'centroid': array([ 0.11360396, 52.19854576,  4.431959  ]), 'mesh_index': 25}, 'Mesh_53': {'average_radiance': 100.03495780670374, 'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11360359387645505, 52.19853376766706, 3.76889409467354]], 'centroid': array([ 0.11360378, 52.19853976,  4.10042655]), 'mesh_index': 26}, 'Mesh_54': {'average_radiance': 100.03495941333544, 'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11360359387645505, 52.19853376766706, 3.76889409467354], [0.1136164265034589, 52.19853810721562, 3.76889409467354]], 'centroid': array([ 0.1136101 , 52.19853894,  3.93466032]), 'mesh_index': 26}, 'Mesh_55': {'average_radiance': 100.03495298680028, 'original_coordinates': [[0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.1135784762368907, 52.19854307592883, 4.763491451281101], [0.11358461874317094, 52.198536252023665, 4.266192772977321]], 'centroid': array([ 0.1135848 , 52.19854225,  4.59772523]), 'mesh_index': 27}, 'Mesh_56': {'average_radiance': 100.03495459343615, 'original_coordinates': [[0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.1135974513701748, 52.198540591572225, 4.266192772977321]], 'centroid': array([ 0.11359113, 52.19854142,  4.431959  ]), 'mesh_index': 27}, 'Mesh_57': {'average_radiance': 100.03496215664637, 'original_coordinates': [[0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11359076124945118, 52.1985294281185, 3.76889409467354]], 'centroid': array([ 0.11359094, 52.19853542,  4.10042655]), 'mesh_index': 28}, 'Mesh_58': {'average_radiance': 100.03496376330487, 'original_coordinates': [[0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11359076124945118, 52.1985294281185, 3.76889409467354], [0.11360359387645505, 52.19853376766706, 3.76889409467354]], 'centroid': array([ 0.11359727, 52.1985346 ,  3.93466032]), 'mesh_index': 28}, 'Mesh_59': {'average_radiance': 100.03496650658313, 'original_coordinates': [[0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11357178611616708, 52.198531912475104, 4.266192772977321], [0.11357792862244732, 52.19852508856994, 3.76889409467354]], 'centroid': array([ 0.11357811, 52.19853108,  4.10042655]), 'mesh_index': 29}, 'Mesh_60': {'average_radiance': 100.03496811322081, 'original_coordinates': [[0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11357792862244732, 52.19852508856994, 3.76889409467354], [0.11359076124945118, 52.1985294281185, 3.76889409467354]], 'centroid': array([ 0.11358444, 52.19853026,  3.93466032]), 'mesh_index': 29}}


# To use the actual data, replace the sample_data with your full rooftop_data
visualize_rooftop_2d(sample_data)

"""
meshes = {'Mesh_1': {'average_radiance': 100.03493472305283,
                     'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321],
                                              [0.11366161450519408, 52.19856228931502, 4.266192772977321],
                                              [0.11366799038650678, 52.198555206146125, 3.75]],
                     'centroid': array([0.11367229, 52.19856282, 4.09412852]), 'mesh_index': 0},
          'Mesh_2': {'average_radiance': 100.03493499579402,
                     'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321],
                                              [0.11366799038650678, 52.198555206146125, 3.75],
                                              [0.1136936556405145, 52.198563885243246, 3.75]],
                     'centroid': array([0.11368298, 52.19856335, 3.92206426]), 'mesh_index': 0},
          'Mesh_3': {'average_radiance': 100.03492804180844,
                     'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881],
                                              [0.11362366423862588, 52.19856725802824, 5.260790129584881],
                                              [0.11363594925118636, 52.19855361021791, 4.266192772977321]],
                     'centroid': array([0.11363631, 52.1985656, 4.92925768]), 'mesh_index': 1},
          'Mesh_4': {'average_radiance': 100.03493125505429,
                     'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881],
                                              [0.11363594925118636, 52.19855361021791, 4.266192772977321],
                                              [0.11366161450519408, 52.19856228931502, 4.266192772977321]],
                     'centroid': array([0.11364896, 52.19856395, 4.59772523]), 'mesh_index': 1},
          'Mesh_5': {'average_radiance': 100.03494344099472,
                     'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321],
                                              [0.11363594925118636, 52.19855361021791, 4.266192772977321],
                                              [0.11364232513249907, 52.198546527049004, 3.75]],
                     'centroid': array([0.11364663, 52.19855414, 4.09412852]), 'mesh_index': 2},
          'Mesh_6': {'average_radiance': 100.03494369574643,
                     'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321],
                                              [0.11364232513249907, 52.198546527049004, 3.75],
                                              [0.11366799038650678, 52.198555206146125, 3.75]],
                     'centroid': array([0.11365731, 52.19855467, 3.92206426]), 'mesh_index': 2},
          'Mesh_7': {'average_radiance': 100.03493672370614,
                     'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881],
                                              [0.11359799898461817, 52.19855857893112, 5.260790129584881],
                                              [0.11361028399717865, 52.198544931120786, 4.266192772977321]],
                     'centroid': array([0.11361065, 52.19855692, 4.92925768]), 'mesh_index': 3},
          'Mesh_8': {'average_radiance': 100.03493993696398,
                     'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881],
                                              [0.11361028399717865, 52.198544931120786, 4.266192772977321],
                                              [0.11363594925118636, 52.19855361021791, 4.266192772977321]],
                     'centroid': array([0.1136233, 52.19855527, 4.59772523]), 'mesh_index': 3},
          'Mesh_9': {'average_radiance': 100.03495212290215,
                     'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321],
                                              [0.11361028399717865, 52.198544931120786, 4.266192772977321],
                                              [0.11361665987849136, 52.19853784795189, 3.75]],
                     'centroid': array([0.11362096, 52.19854546, 4.09412852]), 'mesh_index': 4},
          'Mesh_10': {'average_radiance': 100.03495241368665,
                      'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321],
                                               [0.11361665987849136, 52.19853784795189, 3.75],
                                               [0.11364232513249907, 52.198546527049004, 3.75]],
                      'centroid': array([0.11363164, 52.198546, 3.92206426]), 'mesh_index': 4},
          'Mesh_11': {'average_radiance': 100.03496082279736,
                      'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321],
                                               [0.11358461874317094, 52.198536252023665, 4.266192772977321],
                                               [0.11359099462448365, 52.19852916885477, 3.75]],
                      'centroid': array([0.1135953, 52.19853678, 4.09412852]), 'mesh_index': 5},
          'Mesh_12': {'average_radiance': 100.03496109558051,
                      'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321],
                                               [0.11359099462448365, 52.19852916885477, 3.75],
                                               [0.11361665987849136, 52.19853784795189, 3.75]],
                      'centroid': array([0.11360598, 52.19853732, 3.92206426]), 'mesh_index': 5}}



meshes = {'Mesh_1': {'average_radiance': 100.03492735694, 'original_coordinates': [[0.11370011238620566, 52.1985753079607, 4.266192772977321], [0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11369342226548204, 52.198564144506975, 3.76889409467354]], 'centroid': array([ 0.1136936 , 52.19857014,  4.10042655]), 'mesh_index': 0}, 'Mesh_2': {'average_radiance': 100.03492896355068, 'original_coordinates': [[0.11370011238620566, 52.1985753079607, 4.266192772977321], [0.11369342226548204, 52.198564144506975, 3.76889409467354], [0.1137062548924859, 52.198568484055535, 3.76889409467354]], 'centroid': array([ 0.11369993, 52.19856931,  3.93466032]), 'mesh_index': 0}, 'Mesh_3': {'average_radiance': 100.03492253709966, 'original_coordinates': [[0.11368113725292155, 52.19857779231731, 4.763491451281101], [0.11366830462591769, 52.19857345276875, 4.763491451281101], [0.11367444713219793, 52.19856662886358, 4.266192772977321]], 'centroid': array([ 0.11367463, 52.19857262,  4.59772523]), 'mesh_index': 1}, 'Mesh_4': {'average_radiance': 100.0349241437383, 'original_coordinates': [[0.11368113725292155, 52.19857779231731, 4.763491451281101], [0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.1136872797592018, 52.19857096841214, 4.266192772977321]], 'centroid': array([ 0.11368095, 52.1985718 ,  4.431959  ]), 'mesh_index': 1}, 'Mesh_5': {'average_radiance': 100.03493170694773, 'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.11368058963847819, 52.198559804958414, 3.76889409467354]], 'centroid': array([ 0.11368077, 52.1985658 ,  4.10042655]), 'mesh_index': 2}, 'Mesh_6': {'average_radiance': 100.03493331353764, 'original_coordinates': [[0.1136872797592018, 52.19857096841214, 4.266192772977321], [0.11368058963847819, 52.198559804958414, 3.76889409467354], [0.11369342226548204, 52.198564144506975, 3.76889409467354]], 'centroid': array([ 0.1136871 , 52.19856497,  3.93466032]), 'mesh_index': 2}, 'Mesh_7': {'average_radiance': 100.03491771724687, 'original_coordinates': [[0.11366216211963745, 52.198580276673916, 5.260790129584881], [0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11365547199891383, 52.19856911322019, 4.763491451281101]], 'centroid': array([ 0.11365565, 52.19857511,  5.0950239 ]), 'mesh_index': 3}, 'Mesh_8': {'average_radiance': 100.03491932386585, 'original_coordinates': [[0.11366216211963745, 52.198580276673916, 5.260790129584881], [0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11366830462591769, 52.19857345276875, 4.763491451281101]], 'centroid': array([ 0.11366198, 52.19857428,  4.92925768]), 'mesh_index': 3}, 'Mesh_9': {'average_radiance': 100.0349268870746, 'original_coordinates': [[0.11366830462591769, 52.19857345276875, 4.763491451281101], [0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11366161450519408, 52.19856228931502, 4.266192772977321]], 'centroid': array([ 0.1136618 , 52.19856829,  4.59772523]), 'mesh_index': 4}, 'Mesh_10': {'average_radiance': 100.03492849369242, 'original_coordinates': [[0.11366830462591769, 52.19857345276875, 4.763491451281101], [0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11367444713219793, 52.19856662886358, 4.266192772977321]], 'centroid': array([ 0.11366812, 52.19856746,  4.431959  ]), 'mesh_index': 4}, 'Mesh_11': {'average_radiance': 100.03493605690203, 'original_coordinates': [[0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11366775701147433, 52.198555465409854, 3.76889409467354]], 'centroid': array([ 0.11366794, 52.19856146,  4.10042655]), 'mesh_index': 5}, 'Mesh_12': {'average_radiance': 100.03493766351869, 'original_coordinates': [[0.11367444713219793, 52.19856662886358, 4.266192772977321], [0.11366775701147433, 52.198555465409854, 3.76889409467354], [0.11368058963847819, 52.198559804958414, 3.76889409467354]], 'centroid': array([ 0.11367426, 52.19856063,  3.93466032]), 'mesh_index': 5}, 'Mesh_13': {'average_radiance': 100.03491293340291, 'original_coordinates': [[0.11364318698635335, 52.19858276103052, 5.75808880788866], [0.1136303543593495, 52.19857842148197, 5.75808880788866], [0.11363649686562974, 52.1985715975768, 5.260790129584881]], 'centroid': array([ 0.11363668, 52.19857759,  5.59232258]), 'mesh_index': 6}, 'Mesh_14': {'average_radiance': 100.03491454002604, 'original_coordinates': [[0.11364318698635335, 52.19858276103052, 5.75808880788866], [0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.1136493294926336, 52.198575937125355, 5.260790129584881]], 'centroid': array([ 0.113643  , 52.19857677,  5.42655636]), 'mesh_index': 6}, 'Mesh_15': {'average_radiance': 100.03492210323482, 'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.11364263937190998, 52.19856477367163, 4.763491451281101]], 'centroid': array([ 0.11364282, 52.19857077,  5.0950239 ]), 'mesh_index': 7}, 'Mesh_16': {'average_radiance': 100.03492367383478, 'original_coordinates': [[0.1136493294926336, 52.198575937125355, 5.260790129584881], [0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11365547199891383, 52.19856911322019, 4.763491451281101]], 'centroid': array([ 0.11364915, 52.19856994,  4.92925768]), 'mesh_index': 7}, 'Mesh_17': {'average_radiance': 100.03493123704362, 'original_coordinates': [[0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11364878187819022, 52.19855794976646, 4.266192772977321]], 'centroid': array([ 0.11364896, 52.19856395,  4.59772523]), 'mesh_index': 8}, 'Mesh_18': {'average_radiance': 100.03493284366448, 'original_coordinates': [[0.11365547199891383, 52.19856911322019, 4.763491451281101], [0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11366161450519408, 52.19856228931502, 4.266192772977321]], 'centroid': array([ 0.11365529, 52.19856312,  4.431959  ]), 'mesh_index': 8}, 'Mesh_19': {'average_radiance': 100.03494040687416, 'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11365492438447047, 52.19855112586129, 3.76889409467354]], 'centroid': array([ 0.11365511, 52.19855712,  4.10042655]), 'mesh_index': 9}, 'Mesh_20': {'average_radiance': 100.03494201349382, 'original_coordinates': [[0.11366161450519408, 52.19856228931502, 4.266192772977321], [0.11365492438447047, 52.19855112586129, 3.76889409467354], [0.11366775701147433, 52.198555465409854, 3.76889409467354]], 'centroid': array([ 0.11366143, 52.19855629,  3.93466032]), 'mesh_index': 9}, 'Mesh_21': {'average_radiance': 100.03490807750396, 'original_coordinates': [[0.11362421185306926, 52.198585245387136, 6.25538748619244], [0.1136113792260654, 52.198580905838575, 6.25538748619244], [0.11361752173234564, 52.19857408193341, 5.75808880788866]], 'centroid': array([ 0.1136177 , 52.19858008,  6.08962126]), 'mesh_index': 10}, 'Mesh_22': {'average_radiance': 100.03490968413124, 'original_coordinates': [[0.11362421185306926, 52.198585245387136, 6.25538748619244], [0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.1136303543593495, 52.19857842148197, 5.75808880788866]], 'centroid': array([ 0.11362403, 52.19857925,  5.92385503]), 'mesh_index': 10}, 'Mesh_23': {'average_radiance': 100.03491724733854, 'original_coordinates': [[0.1136303543593495, 52.19857842148197, 5.75808880788866], [0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.11362366423862588, 52.19856725802824, 5.260790129584881]], 'centroid': array([ 0.11362385, 52.19857325,  5.59232258]), 'mesh_index': 11}, 'Mesh_24': {'average_radiance': 100.03491885396468, 'original_coordinates': [[0.1136303543593495, 52.19857842148197, 5.75808880788866], [0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11363649686562974, 52.1985715975768, 5.260790129584881]], 'centroid': array([ 0.11363017, 52.19857243,  5.42655636]), 'mesh_index': 11}, 'Mesh_25': {'average_radiance': 100.03492641717281, 'original_coordinates': [[0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11362980674490612, 52.198560434123074, 4.763491451281101]], 'centroid': array([ 0.11362999, 52.19856643,  5.0950239 ]), 'mesh_index': 12}, 'Mesh_26': {'average_radiance': 100.03492805981982, 'original_coordinates': [[0.11363649686562974, 52.1985715975768, 5.260790129584881], [0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11364263937190998, 52.19856477367163, 4.763491451281101]], 'centroid': array([ 0.11363631, 52.1985656 ,  4.92925768]), 'mesh_index': 12}, 'Mesh_27': {'average_radiance': 100.03493562302803, 'original_coordinates': [[0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11363594925118636, 52.19855361021791, 4.266192772977321]], 'centroid': array([ 0.11363613, 52.19855961,  4.59772523]), 'mesh_index': 13}, 'Mesh_28': {'average_radiance': 100.03493722965196, 'original_coordinates': [[0.11364263937190998, 52.19856477367163, 4.763491451281101], [0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11364878187819022, 52.19855794976646, 4.266192772977321]], 'centroid': array([ 0.11364246, 52.19855878,  4.431959  ]), 'mesh_index': 13}, 'Mesh_29': {'average_radiance': 100.03494479286172, 'original_coordinates': [[0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11364209175746662, 52.19854678631274, 3.76889409467354]], 'centroid': array([ 0.11364227, 52.19855278,  4.10042655]), 'mesh_index': 14}, 'Mesh_30': {'average_radiance': 100.03494639948435, 'original_coordinates': [[0.11364878187819022, 52.19855794976646, 4.266192772977321], [0.11364209175746662, 52.19854678631274, 3.76889409467354], [0.11365492438447047, 52.19855112586129, 3.76889409467354]], 'centroid': array([ 0.1136486 , 52.19855195,  3.93466032]), 'mesh_index': 14}, 'Mesh_31': {'average_radiance': 100.03491242745186, 'original_coordinates': [[0.1136113792260654, 52.198580905838575, 6.25538748619244], [0.11359854659906155, 52.198576566290015, 6.25538748619244], [0.11360468910534179, 52.19856974238485, 5.75808880788866]], 'centroid': array([ 0.11360487, 52.19857574,  6.08962126]), 'mesh_index': 15}, 'Mesh_32': {'average_radiance': 100.03491403408214, 'original_coordinates': [[0.1136113792260654, 52.198580905838575, 6.25538748619244], [0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11361752173234564, 52.19857408193341, 5.75808880788866]], 'centroid': array([ 0.1136112 , 52.19857491,  5.92385503]), 'mesh_index': 15}, 'Mesh_33': {'average_radiance': 100.03492159728954, 'original_coordinates': [[0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11361083161162203, 52.19856291847968, 5.260790129584881]], 'centroid': array([ 0.11361101, 52.19856891,  5.59232258]), 'mesh_index': 16}, 'Mesh_34': {'average_radiance': 100.03492320391868, 'original_coordinates': [[0.11361752173234564, 52.19857408193341, 5.75808880788866], [0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11362366423862588, 52.19856725802824, 5.260790129584881]], 'centroid': array([ 0.11361734, 52.19856809,  5.42655636]), 'mesh_index': 16}, 'Mesh_35': {'average_radiance': 100.03493076712694, 'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11361697411790227, 52.19855609457451, 4.763491451281101]], 'centroid': array([ 0.11361716, 52.19856209,  5.0950239 ]), 'mesh_index': 17}, 'Mesh_36': {'average_radiance': 100.03493237375493, 'original_coordinates': [[0.11362366423862588, 52.19856725802824, 5.260790129584881], [0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11362980674490612, 52.198560434123074, 4.763491451281101]], 'centroid': array([ 0.11362348, 52.19856126,  4.92925768]), 'mesh_index': 17}, 'Mesh_37': {'average_radiance': 100.03493993696398, 'original_coordinates': [[0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11362311662418251, 52.198549270669346, 4.266192772977321]], 'centroid': array([ 0.1136233 , 52.19855527,  4.59772523]), 'mesh_index': 18}, 'Mesh_38': {'average_radiance': 100.0349415435908, 'original_coordinates': [[0.11362980674490612, 52.198560434123074, 4.763491451281101], [0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.11363594925118636, 52.19855361021791, 4.266192772977321]], 'centroid': array([ 0.11362962, 52.19855444,  4.431959  ]), 'mesh_index': 18}, 'Mesh_39': {'average_radiance': 100.03494910680072, 'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.11362925913046276, 52.19854244676418, 3.76889409467354]], 'centroid': array([ 0.11362944, 52.19854844,  4.10042655]), 'mesh_index': 19}, 'Mesh_40': {'average_radiance': 100.03495071342643, 'original_coordinates': [[0.11363594925118636, 52.19855361021791, 4.266192772977321], [0.11362925913046276, 52.19854244676418, 3.76889409467354], [0.11364209175746662, 52.19854678631274, 3.76889409467354]], 'centroid': array([ 0.11363577, 52.19854761,  3.93466032]), 'mesh_index': 19}, 'Mesh_41': {'average_radiance': 100.03492594723464, 'original_coordinates': [[0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11359185647833793, 52.19856540283629, 5.75808880788866], [0.11359799898461817, 52.19855857893112, 5.260790129584881]], 'centroid': array([ 0.11359818, 52.19856457,  5.59232258]), 'mesh_index': 20}, 'Mesh_42': {'average_radiance': 100.0349275538668, 'original_coordinates': [[0.11360468910534179, 52.19856974238485, 5.75808880788866], [0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11361083161162203, 52.19856291847968, 5.260790129584881]], 'centroid': array([ 0.11360451, 52.19856375,  5.42655636]), 'mesh_index': 20}, 'Mesh_43': {'average_radiance': 100.03493511707515, 'original_coordinates': [[0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11360414149089841, 52.19855175502595, 4.763491451281101]], 'centroid': array([ 0.11360432, 52.19855775,  5.0950239 ]), 'mesh_index': 21}, 'Mesh_44': {'average_radiance': 100.03493672370614, 'original_coordinates': [[0.11361083161162203, 52.19856291847968, 5.260790129584881], [0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.11361697411790227, 52.19855609457451, 4.763491451281101]], 'centroid': array([ 0.11361065, 52.19855692,  4.92925768]), 'mesh_index': 21}, 'Mesh_45': {'average_radiance': 100.03494428691532, 'original_coordinates': [[0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.11361028399717865, 52.198544931120786, 4.266192772977321]], 'centroid': array([ 0.11361047, 52.19855093,  4.59772523]), 'mesh_index': 22}, 'Mesh_46': {'average_radiance': 100.03494589354518, 'original_coordinates': [[0.11361697411790227, 52.19855609457451, 4.763491451281101], [0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11362311662418251, 52.198549270669346, 4.266192772977321]], 'centroid': array([ 0.11361679, 52.1985501 ,  4.431959  ]), 'mesh_index': 22}, 'Mesh_47': {'average_radiance': 100.03495345675516, 'original_coordinates': [[0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.1136164265034589, 52.19853810721562, 3.76889409467354]], 'centroid': array([ 0.11361661, 52.1985441 ,  4.10042655]), 'mesh_index': 23}, 'Mesh_48': {'average_radiance': 100.03495506338388, 'original_coordinates': [[0.11362311662418251, 52.198549270669346, 4.266192772977321], [0.1136164265034589, 52.19853810721562, 3.76889409467354], [0.11362925913046276, 52.19854244676418, 3.76889409467354]], 'centroid': array([ 0.11362293, 52.19854327,  3.93466032]), 'mesh_index': 23}, 'Mesh_49': {'average_radiance': 100.03493946701747, 'original_coordinates': [[0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11358516635761431, 52.19855423938256, 5.260790129584881], [0.11359130886389456, 52.19854741547739, 4.763491451281101]], 'centroid': array([ 0.11359149, 52.19855341,  5.0950239 ]), 'mesh_index': 24}, 'Mesh_50': {'average_radiance': 100.03494107365147, 'original_coordinates': [[0.11359799898461817, 52.19855857893112, 5.260790129584881], [0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.11360414149089841, 52.19855175502595, 4.763491451281101]], 'centroid': array([ 0.11359782, 52.19855258,  4.92925768]), 'mesh_index': 24}, 'Mesh_51': {'average_radiance': 100.03494863686075, 'original_coordinates': [[0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.1135974513701748, 52.198540591572225, 4.266192772977321]], 'centroid': array([ 0.11359763, 52.19854659,  4.59772523]), 'mesh_index': 25}, 'Mesh_52': {'average_radiance': 100.03495024349361, 'original_coordinates': [[0.11360414149089841, 52.19855175502595, 4.763491451281101], [0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11361028399717865, 52.198544931120786, 4.266192772977321]], 'centroid': array([ 0.11360396, 52.19854576,  4.431959  ]), 'mesh_index': 25}, 'Mesh_53': {'average_radiance': 100.03495780670374, 'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11360359387645505, 52.19853376766706, 3.76889409467354]], 'centroid': array([ 0.11360378, 52.19853976,  4.10042655]), 'mesh_index': 26}, 'Mesh_54': {'average_radiance': 100.03495941333544, 'original_coordinates': [[0.11361028399717865, 52.198544931120786, 4.266192772977321], [0.11360359387645505, 52.19853376766706, 3.76889409467354], [0.1136164265034589, 52.19853810721562, 3.76889409467354]], 'centroid': array([ 0.1136101 , 52.19853894,  3.93466032]), 'mesh_index': 26}, 'Mesh_55': {'average_radiance': 100.03495298680028, 'original_coordinates': [[0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.1135784762368907, 52.19854307592883, 4.763491451281101], [0.11358461874317094, 52.198536252023665, 4.266192772977321]], 'centroid': array([ 0.1135848 , 52.19854225,  4.59772523]), 'mesh_index': 27}, 'Mesh_56': {'average_radiance': 100.03495459343615, 'original_coordinates': [[0.11359130886389456, 52.19854741547739, 4.763491451281101], [0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.1135974513701748, 52.198540591572225, 4.266192772977321]], 'centroid': array([ 0.11359113, 52.19854142,  4.431959  ]), 'mesh_index': 27}, 'Mesh_57': {'average_radiance': 100.03496215664637, 'original_coordinates': [[0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11359076124945118, 52.1985294281185, 3.76889409467354]], 'centroid': array([ 0.11359094, 52.19853542,  4.10042655]), 'mesh_index': 28}, 'Mesh_58': {'average_radiance': 100.03496376330487, 'original_coordinates': [[0.1135974513701748, 52.198540591572225, 4.266192772977321], [0.11359076124945118, 52.1985294281185, 3.76889409467354], [0.11360359387645505, 52.19853376766706, 3.76889409467354]], 'centroid': array([ 0.11359727, 52.1985346 ,  3.93466032]), 'mesh_index': 28}, 'Mesh_59': {'average_radiance': 100.03496650658313, 'original_coordinates': [[0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11357178611616708, 52.198531912475104, 4.266192772977321], [0.11357792862244732, 52.19852508856994, 3.76889409467354]], 'centroid': array([ 0.11357811, 52.19853108,  4.10042655]), 'mesh_index': 29}, 'Mesh_60': {'average_radiance': 100.03496811322081, 'original_coordinates': [[0.11358461874317094, 52.198536252023665, 4.266192772977321], [0.11357792862244732, 52.19852508856994, 3.76889409467354], [0.11359076124945118, 52.1985294281185, 3.76889409467354]], 'centroid': array([ 0.11358444, 52.19853026,  3.93466032]), 'mesh_index': 29}}
"""